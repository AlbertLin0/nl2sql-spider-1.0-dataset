CREATE TABLE "users" (
  "user_id" INT GENERATED BY DEFAULT AS IDENTITY,
  "age_category_code" varchar(15)  DEFAULT NULL,
  "user_category_code" varchar(15)  DEFAULT NULL,
  "user_address_id" int NOT NULL,
  "is_buyer" varchar(1)  DEFAULT NULL,
  "is_seller" varchar(1)  DEFAULT NULL,
  "login_name" varchar(25)  DEFAULT NULL,
  "password" varchar(8)  DEFAULT NULL,
  "date_registered" TIMESTAMP DEFAULT NULL,
  "first_name" varchar(80)  DEFAULT NULL,
  "middle_name" varchar(80)  DEFAULT NULL,
  "last_name" varchar(80)  DEFAULT NULL,
  "other_user_details" varchar(255)  DEFAULT NULL,
  PRIMARY KEY ("user_id")
) ;

CREATE TABLE "addresses" (
  "address_id" INT GENERATED BY DEFAULT AS IDENTITY,
  "line_1_number_building" varchar(80)  DEFAULT NULL,
  "line_2_number_street" varchar(80)  DEFAULT NULL,
  "line_3_area_locality" varchar(80)  DEFAULT NULL,
  "town_city" varchar(80)  DEFAULT NULL,
  "zip_postcode" varchar(20)  DEFAULT NULL,
  "county_state_province" varchar(80)  DEFAULT NULL,
  "country" varchar(50)  DEFAULT NULL,
  "other_address_details" varchar(255)  DEFAULT NULL,
  PRIMARY KEY ("address_id")
) ;


CREATE TABLE "features" (
  "feature_id" INT GENERATED BY DEFAULT AS IDENTITY,
  "feature_name" varchar(80)  DEFAULT NULL,
  "feature_description" varchar(80)  DEFAULT NULL,
  PRIMARY KEY ("feature_id")
) ;




CREATE TABLE "ref_age_categories" (
  "age_category_code" varchar(15)  NOT NULL,
  "age_category_description" varchar(80)  DEFAULT NULL,
  PRIMARY KEY ("age_category_code")
) ;


CREATE TABLE "ref_property_types" (
  "property_type_code" int  NOT NULL,
  "property_type_description" varchar(80)  DEFAULT NULL,
  PRIMARY KEY ("property_type_code")
) ;


CREATE TABLE "ref_room_types" (
  "room_type_code" INT NOT NULL,
  "room_type_description" varchar(80)  DEFAULT NULL,
  PRIMARY KEY ("room_type_code")
) ;


CREATE TABLE "ref_user_categories" (
  "user_category_code" varchar(15)  NOT NULL,
  "user_category_description" varchar(80)  DEFAULT NULL,
  PRIMARY KEY ("user_category_code")
) ;


CREATE TABLE "properties" (
  "property_id" INT GENERATED BY DEFAULT AS IDENTITY,
  "property_address_id" int NOT NULL,
  "owner_user_id" int NOT NULL,
  "property_type_code" INT  NOT NULL,
  "date_on_market" TIMESTAMP DEFAULT NULL,
  "date_off_market" TIMESTAMP DEFAULT NULL,
  "property_name" varchar(80)  DEFAULT NULL,
  "property_description" varchar(255)  DEFAULT NULL,
  "garage_yn" varchar(1)  DEFAULT NULL,
  "parking_lots" varchar(1)  DEFAULT NULL,
  "room_count" INT  DEFAULT NULL,
  "vendor_requested_price" DOUBLE PRECISION DEFAULT NULL,
  "price_min" DOUBLE PRECISION DEFAULT NULL,
  "price_max" DOUBLE PRECISION DEFAULT NULL,
  "other_property_details" varchar(255)  DEFAULT NULL,
  PRIMARY KEY ("property_id"),
  CONSTRAINT "properties_fk_0_0" FOREIGN KEY ("property_type_code") REFERENCES "ref_property_types" ("property_type_code"),
  CONSTRAINT "properties_fk_1_0" FOREIGN KEY ("property_address_id") REFERENCES "addresses" ("address_id"),
  CONSTRAINT "properties_fk_2_0" FOREIGN KEY ("owner_user_id") REFERENCES "users" ("user_id")
) ;


CREATE TABLE "property_features" (
  "property_id" int NOT NULL,
  "feature_id" int NOT NULL,
  "feature_value" varchar(80)  DEFAULT NULL,
  "property_feature_description" varchar(80)  DEFAULT NULL,
  CONSTRAINT "property_features_fk_0_0" FOREIGN KEY ("property_id") REFERENCES "properties" ("property_id"),
  CONSTRAINT "property_features_fk_1_0" FOREIGN KEY ("feature_id") REFERENCES "features" ("feature_id")
) ;



CREATE TABLE "property_photos" (
  "property_id" int NOT NULL,
  "photo_seq" int NOT NULL,
  "photo_title" varchar(30)  DEFAULT NULL,
  "photo_description" varchar(255)  DEFAULT NULL,
  "photo_filename" varchar(255)  DEFAULT NULL,
  CONSTRAINT "property_photos_fk_0_0" FOREIGN KEY ("property_id") REFERENCES "properties" ("property_id")
) ;



CREATE TABLE "rooms" (
  "property_id" int NOT NULL,
  "room_number" INT  NOT NULL,
  "room_type_code" INT  NOT NULL,
  "room_size" varchar(20)  DEFAULT NULL,
  "other_room_details" varchar(255)  DEFAULT NULL,
  CONSTRAINT "rooms_fk_0_0" FOREIGN KEY ("room_type_code") REFERENCES "ref_room_types" ("room_type_code"),
  CONSTRAINT "rooms_fk_1_0" FOREIGN KEY ("property_id") REFERENCES "properties" ("property_id")
) ;


CREATE TABLE "user_property_history" (
  "user_id" int NOT NULL,
  "property_id" int NOT NULL,
  "datestamp" TIMESTAMP NOT NULL,
  CONSTRAINT "user_property_history_fk_0_0" FOREIGN KEY ("property_id") REFERENCES "properties" ("property_id"),
  CONSTRAINT "user_property_history_fk_1_0" FOREIGN KEY ("user_id") REFERENCES "users" ("user_id")
) ;


CREATE TABLE "user_searches" (
  "user_id" int NOT NULL,
  "search_seq" int NOT NULL,
  "search_datetime" TIMESTAMP DEFAULT NULL,
  "search_string" varchar(80)  DEFAULT NULL,
  CONSTRAINT "user_searches_fk_0_0" FOREIGN KEY ("user_id") REFERENCES "users" ("user_id")
) ;




